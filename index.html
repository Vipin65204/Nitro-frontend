<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <style>

    </style>

    <!-- Include Axios from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- <script src="apiURL.js"></script> -->
    <script src="func.js"></script>


    <script>
        $(document).ready(function () {


            // let checkboxSelection = 0
            $('#contentDiv').hide();
            // let globalVariable; // id
            // let dd;

            // let sourceData = {
            //     isLoading: true,
            //     checkboxSelection: 0,
            //     sortBy: ['weekNumber', 'author', 'location'],
            //     viewBy: ['author', 'formattedTime', 'author'],
            //     data: [],
            //     uniqueArrayObj: [],
            //     photoURL: `https://picsum.photos/id/${globalVariable}/50/50`


            // }

            fetchData();
            // axios.get('http://localhost:3000/posts')
            //     .then(function (response) {
            //         console.log('Axios response:', response.data);

            //         // Append response.data to sourceData.data
            //         sourceData.data = response.data;
            //         console.log('obj', sourceData);



            //         //function to create date and time from timestamp
            //         function getWeekNumAndYear(timestamp) {
            //             const date = new Date(timestamp * 1000); // Convert seconds to milliseconds
            //             const onejan = new Date(date.getFullYear(), 0, 1);
            //             const millisecsInDay = 86400000; // 24 * 60 * 60 * 1000
            //             const dayOfYear = (date - onejan) / millisecsInDay;
            //             const weekNumber = Math.ceil((dayOfYear + onejan.getDay() + 1) / 7);

            //             const year = date.getFullYear();
            //             return { weekNumber, year };
            //         }

            //         // Add the "weekNumber" and "year" properties to each item in the array
            //         sourceData.data.forEach(item => {
            //             const { weekNumber, year } = getWeekNumAndYear(item.time);
            //             item.weekNumber = weekNumber;
            //             item.year = year;
            //             item.formattedTime = formatTimestamp(item.time);
            //         });




            //         populate = () => {
            //             const uniqueSet = new Set();

            //             //  0 == week
            //             //  1 == author
            //             //  2 == location

            //             sourceData.data.forEach(entry => {
            //                 //  uniqueSet.add(entry.weekNumber);
            //                 const chkbox = sourceData.checkboxSelection
            //                 // console.log('chkbk',chkbox);
            //                 const sortByValue = entry[sourceData.sortBy[chkbox]];
            //                 uniqueSet.add(sortByValue);
            //             });
            //             const uniqueArray = Array.from(uniqueSet);
            //             sourceData.uniqueArrayObj = uniqueArray
            //             console.log("uniquey array", uniqueArray);

            //             const $ulElement = $('#myUL');
            //             $.each(sourceData.uniqueArrayObj, function (index, wk) {
            //                 // Create a new list item element with a span inside it
            //                 const listItem = $('<li><span class="caret">week ' + wk + '</span></li>');

            //                 // Append the list item element to the unordered list
            //                 $ulElement.append(listItem);
            //                 const ulElementNested = $('<ul class="nested"></ul>');

            //                 listItem.append(ulElementNested);


            //                 // ------ end of post by author --------
            //                 console.log('wk', wk);
            //                 //  ------ post by location ------
            //                 const locationPost = sourceData.data.filter(item => item[sourceData.sortBy[sourceData.checkboxSelection]] === wk);
            //                 locationPost.forEach(postsByWeek => {



            //                     timeStampItem = postsByWeek[sourceData.viewBy[sourceData.checkboxSelection]];

            //                     const liElement = $(`<li>${postsByWeek[sourceData.viewBy[sourceData.checkboxSelection]]}</li>`);

            //                     console.log('time', postsByWeek[sourceData.viewBy[sourceData.checkboxSelection]]);

            //                     liElement.click(function () {
            //                         globalVariable = postsByWeek.id
            //                         $('#contentDiv').show();


            //                         $('.profile-image').attr('src', `https://picsum.photos/id/${globalVariable}/50/50`);

            //                         $('#post-content').text(postsByWeek.text);
            //                         $('#post-auth').text(postsByWeek.author);
            //                         $('#post-time').text(`Posted on ${formatTimestamp(postsByWeek.time)} |`);
            //                         $('#post-location').text(`Location: ${postsByWeek.location}`);

            //                     });

            //                     // // Append the LI element to the UL element
            //                     ulElementNested.append(liElement);
            //                     //  ------ post by location end------
            //                 });
            //             });

            //             var toggler = document.getElementsByClassName("caret");
            //             var i;

            //             for (i = 0; i < toggler.length; i++) {

            //                 toggler[i].addEventListener("click", function () {
            //                     this.parentElement.querySelector(".nested").classList.toggle("active");
            //                     this.classList.toggle("caret-down");

            //                 });
            //             }

            //         } // end of populate

            //         populate();

            //         // timestamp formatting
            //         function formatTimestamp(timestamp) {
            //             const date = new Date(timestamp * 1000);

            //             const options = {
            //                 year: 'numeric',
            //                 month: 'long',
            //                 day: 'numeric',
            //                 hour: 'numeric',
            //                 minute: 'numeric',
            //                 hour12: true
            //             };

            //             return date.toLocaleString('en-US', options);
            //         }



            //         $('#edit-button').click(function () {

            //             const editPost = sourceData.data.find(item => item.id === globalVariable);

            //             console.log("editpost", editPost.id);
            //             $('#locationInput').val(editPost.location);
            //             $('#authorInput').val(editPost.author);

            //         });

            //         $('#saveChangesBtn').click(function () {


            //             // Get the updated values from the input fields
            //             const newLocation = $('#locationInput').val();
            //             const newAuthor = $('#authorInput').val();

            //             const isValidLocation = /^[a-zA-Z\s]+$/.test(newLocation);
            //             const isValidAuthor = /^[a-zA-Z\s]+$/.test(newAuthor);

            //             // Check if the location is valid
            //             if (isValidLocation && isValidAuthor) {
            //                 // Perform the save operation or other logic
            //                 console.log('Location is valid:', newLocation);

            //                 const editedPostIndex = sourceData.data.findIndex(post => post.id === globalVariable);
            //                 console.log("editedPostIndex", editedPostIndex);
            //                 if (editedPostIndex !== -1) {
            //                     sourceData.data[editedPostIndex].location = newLocation;
            //                     sourceData.data[editedPostIndex].author = newAuthor;


            //                     // Append the updated values to the corresponding HTML elements
            //                     $('#post-location').text(`Location: ${newLocation}`);
            //                     $('#post-auth').text(newAuthor);
            //                     console.log('Updated Post:', dd);
            //                 }
            //                 $('#editModal').modal('hide');
            //                 $('#myUL').empty();

            //                 console.log('changed', dd);
            //                 populate();
            //             } else {
            //                 // Display an error or prevent further processing
            //                 alert('Invalid Details .Please enter only letters and spaces.');
            //             }

            //             // Find the post in the array and update its properties
            //             // const editedPostIndex = sourceData.data.findIndex(post => post.id === globalVariable);
            //             // console.log("editedPostIndex", editedPostIndex);
            //             // if (editedPostIndex !== -1) {
            //             //     sourceData.data[editedPostIndex].location = newLocation;
            //             //     sourceData.data[editedPostIndex].author = newAuthor;


            //             //     // Append the updated values to the corresponding HTML elements
            //             //     $('#post-location').text(`Location: ${newLocation}`);
            //             //     $('#post-auth').text(newAuthor);
            //             //     console.log('Updated Post:', dd);
            //             // }
            //             // $('#editModal').modal('hide');
            //             // $('#myUL').empty();

            //             // console.log('changed', dd);
            //             // populate();


            //         });




            //     })
            //     .catch(function (error) {
            //         console.error('Axios error:', error);
            //     });



            // $('input[name="group1"]').on('change', function () {
            //     // Get the selected radio button value
            //     const selectedValue = $('input[name="group1"]:checked').val();
            //     sourceData.checkboxSelection = selectedValue;

            //     $('#myUL').empty();
            //     populate()


            //     $('#contentDiv').hide();


            // });



        });




    </script>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <link rel="stylesheet" href="index.css">
</head>

<body>
    <div class="container">
        <!-- nav bar -->
        <div class="row">


            <div class="col-12">

                <nav class="navbar fixed-top navbar-light bg-dark" style="height: 100px;">
                    <div class="container-fluid" style="width:80%;border: 2px red solid;">
                        <a class="navbar-brand " href="#">Blog Post</a>
                    </div>
                </nav>
            </div>
        </div>

        <!-- side bar -->
        <div class="row" style="margin-top: 100px;">
            <!-- radio test -->

            <div class="col-2" style="border: 2px green solid;">
                <p> sort by : </p>
            </div>
            <div class="col-10" style="border: 2px yellow solid;">

                <input type="radio" id="radio1" name="group1" value="0" checked>
                <label for="radio1"><span class="fake-checkbox"></span>Week</label>

                <input type="radio" id="radio2" name="group1" value="1">
                <label for="radio2"><span class="fake-checkbox"></span>Author</label>

                <input type="radio" id="radio3" name="group1" value="2">
                <label for="radio3"><span class="fake-checkbox"></span>Location</label>

            </div>

            <div class="col-3 " style="height:100%;min-height:100vh;border: 2px red solid;color: red;">
                <ul id="myUL">

                </ul>

            </div>
            <!-- content side  -->
            <div class="col-9" style="border: 2px red solid;">


                <div class="row" id="contentDiv" style="margin: 5%;border-bottom: 2px green solid;">
                    <div class="col-2">

                        <!-- Circular Profile Image with Random User Image -->
                        <img src="" alt="Profile Picture" class="profile-image">
                    </div>
                    <div class="col-10">


                        <div class="post-container">
                            <!-- Post Content -->
                            <p class="mt-2 " id="post-content">Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                                Sed et libero nec massa fermentum feugiat.
                            </p>

                            <!-- Author Name -->
                            <p class="font-weight-bold" id="post-auth">John Doe</p>

                            <!-- Date and Time of the Post -->
                            <p class="text-muted" id="timeLoc">
                                <i class="fas fa-clock icon" style="margin-right: 5px;"></i>
                                <span id="post-time">Posted on November 18, 2023 at 3:30 PM | </span>
                                <i class="fas fa-map-marker-alt icon" style="margin-right: 5px;"></i>
                                <span id="post-location">New York, USA</span>
                            </p>
                            <!-- edit button -->
                            <i class="fas fa-edit icon" style="margin-left: 10px;"></i>
                            <span id="edit-button" data-bs-toggle="modal" data-bs-target="#editModal">edit</span>

                        </div>
                        <!-- End of Post Container -->
                    </div>
                </div>
            </div>
            <!-- Edit Modal -->
            <div class="modal" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editModalLabel"
                aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="editModalLabel">Edit Post</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <!-- Input fields for Location and Author Name -->
                            <div class="form-group">
                                <label for="locationInput">Location:</label>
                                <input type="text" class="form-control" id="locationInput">
                            </div>
                            <div class="form-group">
                                <label for="authorInput">Author Name:</label>
                                <input type="text" class="form-control" id="authorInput">
                            </div>
                        </div>
                        <div class="modal-footer">
                            <!-- Save button -->
                            <button type="button" class="btn btn-primary" id="saveChangesBtn">Save Changes</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>




    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
        integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
        crossorigin="anonymous"></script>




    <script>
        //  var toggler = document.getElementsByClassName("caret");
        //     var i;

        //     for (i = 0; i < toggler.length; i++) {

        //         toggler[i].addEventListener("click", function () {
        //             this.parentElement.querySelector(".nested").classList.toggle("active");
        //             this.classList.toggle("caret-down");

        //         });
        //     }



    </script>
</body>

</html>